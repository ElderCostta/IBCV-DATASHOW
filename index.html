<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>IBCV - DATASHOW</title>
  <link rel="manifest" href="manifest.json">
  <style>
    body {
      font-family: Arial, Helvetica, sans-serif;
      text-align: center;
      padding: 20px;
      background: linear-gradient(135deg, #0073e6, #005bb5);
      min-height: 100vh;
      margin: 0;
      color: white;
    }

    .container {
      max-width: 600px;
      margin: 0 auto;
      background: rgba(255, 255, 255, 0.1);
      padding: 30px;
      border-radius: 15px;
      backdrop-filter: blur(10px);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    }

    .logo {
      width: 120px;
      height: 120px;
      margin: 0 auto 20px;
      border-radius: 50%;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
    }

    .logo img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }

    h1 {
      font-family: 'Times New Roman', Times, serif;
      color: white;
      margin-bottom: 30px;
      font-size: 2.5em;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    }

    .config {
      margin-bottom: 30px;
      background: rgba(255, 255, 255, 0.1);
      padding: 20px;
      border-radius: 10px;
    }

    .config label {
      display: block;
      margin: 15px 0;
      text-align: left;
      font-weight: bold;
    }

    .config input {
      width: 100%;
      padding: 12px;
      margin-top: 5px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      background: rgba(255, 255, 255, 0.9);
      color: #333;
    }

    .config input[type="checkbox"] {
      width: auto;
      margin-right: 10px;
      transform: scale(1.2);
    }

    .controles {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
      margin-bottom: 30px;
    }

    button {
      padding: 15px 20px;
      background: linear-gradient(135deg, #0073e6, #005bb5);
      border: none;
      color: white;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0, 115, 230, 0.3);
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 115, 230, 0.4);
      background: linear-gradient(135deg, #005bb5, #004494);
    }

    button:active {
      transform: translateY(0);
    }

    #conectar {
      background: linear-gradient(135deg, #28a745, #20c997);
      box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
      width: 100%;
      margin-top: 10px;
    }

    #conectar:hover {
      background: linear-gradient(135deg, #20c997, #17a2b8);
      box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
    }

    .power-buttons {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      margin-bottom: 20px;
    }

    .power-on {
      background: linear-gradient(135deg, #28a745, #20c997) !important;
    }

    .power-off {
      background: linear-gradient(135deg, #dc3545, #c82333) !important;
    }

    pre {
      background: rgba(0, 0, 0, 0.3);
      padding: 15px;
      border-radius: 8px;
      text-align: left;
      max-width: 100%;
      margin: 20px 0;
      color: #fff;
      font-family: 'Courier New', monospace;
      max-height: 200px;
      overflow-y: auto;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .status-indicator {
      display: inline-block;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      margin-right: 8px;
      background: #dc3545;
    }

    .status-indicator.connected {
      background: #28a745;
    }

    @media (max-width: 600px) {
      .container {
        margin: 10px;
        padding: 20px;
      }
      
      .controles {
        grid-template-columns: 1fr;
      }
      
      .power-buttons {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Logo IBCV -->
    <div class="logo">
      <img src="LogoIBCV.jpg" alt="Logo IBCV">
    </div>

    <h1>IBCV-DATASHOW</h1>

    <div class="config">
      <label>
        <span class="status-indicator" id="statusIndicator"></span>
        IP do Projetor:
        <input id="ip" type="text" placeholder="192.168.0.150" />
      </label>
      <label>
        Senha PJLink:
        <input id="senha" type="password" placeholder="Digite a senha..." />
      </label>
      <label>
        <input id="demo" type="checkbox" />
        Modo Demo (simular comandos)
      </label>
      <button id="conectar">Conectar ao Projetor</button>
    </div>

    <div class="controles">
      <div class="power-buttons">
        <button class="power-on" onclick="enviarComando('%1POWR 1')">üîå Ligar</button>
        <button class="power-off" onclick="enviarComando('%1POWR 0')">‚èª Desligar</button>
      </div>
      
      <button onclick="enviarComando('%1AVMT 31')">üö´ Mudo V√≠deo</button>
      <button onclick="enviarComando('%1AVMT 11')">üîá Mudo √Åudio</button>
      <button onclick="enviarComando('%1AVMT 30')">üì∫ Reativar V√≠deo</button>
      <button onclick="enviarComando('%1AVMT 10')">üîä Reativar √Åudio</button>
      <button onclick="enviarComando('%1INPT 31')">üì± HDMI 1</button>
      <button onclick="enviarComando('%1INPT 32')">üíª HDMI 2</button>
      <button onclick="enviarComando('%1INPT 11')">üñ•Ô∏è VGA 1</button>
      <button onclick="enviarComando('%1INPT 21')">üì° V√≠deo</button>
    </div>

    <div>
      <h3>üìã Log de Atividades:</h3>
      <pre id="log">Aguardando conex√£o...</pre>
      <button onclick="limparLog()">üóëÔ∏è Limpar Log</button>
    </div>
  </div>

  <script>
    let ipProjetor = "";
    let senhaPJLink = "";
    let modoDemo = false;
    let conectado = false;

    // Configura√ß√£o do bridge Node.js
    const ipBridge = "localhost";
    const portaBridge = 3000;

    // Service Worker para PWA
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js')
        .then(() => console.log('SW registered'))
        .catch(error => console.log('SW registration failed', error));
    }

    document.getElementById("conectar").addEventListener("click", () => {
      ipProjetor = document.getElementById("ip").value.trim();
      senhaPJLink = document.getElementById("senha").value.trim();
      modoDemo = document.getElementById("demo").checked;

      if (!ipProjetor && !modoDemo) {
        alert("‚ö†Ô∏è Digite o IP do projetor ou ative o modo DEMO!");
        return;
      }

      conectado = true;
      atualizarStatusIndicador();
      
      const timestamp = new Date().toLocaleTimeString();
      logMsg(`[${timestamp}] ‚úÖ Conectado ao projetor ${ipProjetor || "DEMO"}`);
      logMsg(`[${timestamp}] üîß Modo Demo: ${modoDemo ? 'ATIVADO' : 'DESATIVADO'}`);
      
      if (!modoDemo) {
        testarConexao();
      }
    });

    function testarConexao() {
      logMsg(`[${new Date().toLocaleTimeString()}] üîç Testando conex√£o...`);
      enviarComando('%1POWR ?'); // Consulta status de energia
    }

    function enviarComando(comando) {
      if (!ipProjetor && !modoDemo) {
        alert("‚ö†Ô∏è Digite o IP do projetor ou ative o modo DEMO!");
        return;
      }

      const timestamp = new Date().toLocaleTimeString();
      logMsg(`[${timestamp}] üì§ Enviando: ${comando}`);

      if (modoDemo) {
        setTimeout(() => {
          let resposta = "OK";
          if (comando.includes('POWR ?')) resposta = "1"; 
          else if (comando.includes('POWR 1')) resposta = "Ligando...";
          else if (comando.includes('POWR 0')) resposta = "Desligando...";
          logMsg(`[${new Date().toLocaleTimeString()}] üì• [DEMO] Resposta: ${resposta}`);
        }, 600);
        return;
      }

      fetch(`http://${ipBridge}:${portaBridge}/comando`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ ip: ipProjetor, senha: senhaPJLink, comando })
      })
        .then(res => res.text())
        .then(txt => {
          logMsg(`[${new Date().toLocaleTimeString()}] üì• Resposta: ${txt}`);
          if (txt.includes("erro") || txt.includes("falhou")) {
            conectado = false;
            atualizarStatusIndicador();
          }
        })
        .catch(err => {
          logMsg(`[${new Date().toLocaleTimeString()}] ‚ùå Erro: ${err.message}`);
          conectado = false;
          atualizarStatusIndicador();
        });
    }

    function logMsg(msg) {
      const logElement = document.getElementById("log");
      logElement.textContent += msg + "\n";
      logElement.scrollTop = logElement.scrollHeight;
    }

    function limparLog() {
      document.getElementById("log").textContent = "Log limpo...\n";
    }

    function atualizarStatusIndicador() {
      const indicator = document.getElementById("statusIndicator");
      if (conectado) {
        indicator.classList.add("connected");
      } else {
        indicator.classList.remove("connected");
      }
    }

    // Atalhos de teclado: Ctrl+1 liga, Ctrl+0 desliga
    document.addEventListener('keydown', (e) => {
      if (e.ctrlKey) {
        if (e.key === '1') enviarComando('%1POWR 1');
        if (e.key === '0') enviarComando('%1POWR 0');
      }
    });
  </script>
</body>
</html>
      

  </style>
</head>
<body>
  <div class="container">
    <!-- Logo IBCV -->
    <div class="logo">
      <img src="LogoIBCV.jpg" alt="Logo IBCV">
    </div>

    <h1>IBCV-DATASHOW</h1>

    <div class="config">
      <label>
        <span class="status-indicator" id="statusIndicator"></span>
        IP do Projetor:
        <input id="ip" type="text" placeholder="192.168.0.150" />
      </label>
      <label>
        Senha PJLink:
        <input id="senha" type="password" placeholder="Digite a senha..." />
      </label>
      <label>
        <input id="demo" type="checkbox" />
        Modo Demo (simular comandos)
      </label>
      <button id="conectar">Conectar ao Projetor</button>
    </div>

    <div class="controles">
      <div class="power-buttons">
        <button class="power-on" onclick="enviarComando('%1POWR 1')">üîå Ligar</button>
        <button class="power-off" onclick="enviarComando('%1POWR 0')">‚èª Desligar</button>
      </div>
      
      <button onclick="enviarComando('%1AVMT 31')">üö´ Mudo V√≠deo</button>
      <button onclick="enviarComando('%1AVMT 11')">üîá Mudo √Åudio</button>
      <button onclick="enviarComando('%1AVMT 30')">üì∫ Reativar V√≠deo</button>
      <button onclick="enviarComando('%1AVMT 10')">üîä Reativar √Åudio</button>
      <button onclick="enviarComando('%1INPT 31')">üì± HDMI 1</button>
      <button onclick="enviarComando('%1INPT 32')">üíª HDMI 2</button>
      <button onclick="enviarComando('%1INPT 11')">üñ•Ô∏è VGA 1</button>
      <button onclick="enviarComando('%1INPT 21')">üì° V√≠deo</button>
    </div>

    <div>
      <h3>üìã Log de Atividades:</h3>
      <pre id="log">Aguardando conex√£o...</pre>
      <button onclick="limparLog()">üóëÔ∏è Limpar Log</button>
    </div>
  </div>
   <script>
    let ipProjetor = "";
    let senhaPJLink = "";
    let modoDemo = false;
    let conectado = false;

    // Configura√ß√£o do bridge Node.js
    const ipBridge = "localhost";
    const portaBridge = 3000;

    // Service Worker para PWA
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js')
        .then(registration => console.log('SW registered'))
        .catch(error => console.log('SW registration failed'));
    }

    document.getElementById("conectar").addEventListener("click", () => {
      ipProjetor = document.getElementById("ip").value.trim();
      senhaPJLink = document.getElementById("senha").value.trim();
      modoDemo = document.getElementById("demo").checked;

      if (!ipProjetor && !modoDemo) {
        alert("‚ö†Ô∏è Por favor, digite o IP do projetor ou ative o Modo Demo!");
        return;
      }

      conectado = true;
      atualizarStatusIndicador();
      
      const timestamp = new Date().toLocaleTimeString();
      logMsg(`[${timestamp}] ‚úÖ Conectado ao projetor ${ipProjetor || "DEMO"}`);
      logMsg(`[${timestamp}] üîß Modo Demo: ${modoDemo ? 'ATIVADO' : 'DESATIVADO'}`);
      
      if (!modoDemo) {
        testarConexao();
      }
    });

    function testarConexao() {
      logMsg(`[${new Date().toLocaleTimeString()}] üîç Testando conex√£o...`);
      enviarComando('%1POWR ?'); // Consulta status de energia
    }

    function enviarComando(comando) {
      if (!ipProjetor && !modoDemo) {
        alert("‚ö†Ô∏è Digite o IP do projetor ou ative o modo DEMO!");
        return;
      }

      const timestamp = new Date().toLocaleTimeString();

      // Mostrar alerta sempre que enviar comando
      alert(`üì§ Comando enviado: ${comando}`);

      if (modoDemo) {
        logMsg(`[${timestamp}] üé≠ [DEMO] Comando: ${comando}`);
        
        // Simular resposta baseada no comando
        setTimeout(() => {
          let resposta = "OK";
          if (comando.includes('POWR ?')) resposta = "1"; // Ligado
          else if (comando.includes('POWR 1')) resposta = "Ligando...";
          else if (comando.includes('POWR 0')) resposta = "Desligando...";
          
          logMsg(`[${timestamp}] üì• [DEMO] Resposta: ${resposta}`);
        }, 500);
        return;
      }

      logMsg(`[${timestamp}] üì§ Enviando: ${comando}`);

      fetch(`http://${ipBridge}:${portaBridge}/comando`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          ip: ipProjetor,
          senha: senhaPJLink,
          comando: comando
        })
      })
        .then(res => res.text())
        .then(txt => {
          logMsg(`[${timestamp}] üì• Resposta: ${txt}`);
          if (txt.includes("erro") || txt.includes("falhou")) {
            conectado = false;
            atualizarStatusIndicador();
          }
        })
        .catch(err => {
          logMsg(`[${timestamp}] ‚ùå Erro: ${err.message}`);
          conectado = false;
          atualizarStatusIndicador();
        });
    }

    function logMsg(msg) {
      const logElement = document.getElementById("log");
      logElement.textContent += msg + "\n";
      logElement.scrollTop = logElement.scrollHeight;
    }

    function limparLog() {
      document.getElementById("log").textContent = "Log limpo...\n";
    }

    function atualizarStatusIndicador() {
      const indicator = document.getElementById("statusIndicator");
      if (conectado) {
        indicator.classList.add("connected");
      } else {
        indicator.classList.remove("connected");
      }
    }

    // Carregar configura√ß√µes salvas
    window.addEventListener('load', () => {
      const savedIP =
      justify-content: center;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
    }

    .logo img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }

    h1 {
      font-family: 'Times New Roman', Times, serif;
      color: white;
      margin-bottom: 30px;
      font-size: 2.5em;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    }

    .config {
      margin-bottom: 30px;
      background: rgba(255, 255, 255, 0.1);
      padding: 20px;
      border-radius: 10px;
    }

    .config label {
      display: block;
      margin: 15px 0;
      text-align: left;
      font-weight: bold;
    }

    .config input {
      width: 100%;
      padding: 12px;
      margin-top: 5px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      background: rgba(255, 255, 255, 0.9);
      color: #333;
    }

    .config input[type="checkbox"] {
      width: auto;
      margin-right: 10px;
      transform: scale(1.2);
    }

    .controles {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
      margin-bottom: 30px;
    }

    button {
      padding: 15px 20px;
      background: linear-gradient(135deg, #0073e6, #005bb5);
      border: none;
      color: white;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0, 115, 230, 0.3);
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 115, 230, 0.4);
      background: linear-gradient(135deg, #005bb5, #004494);
    }

    button:active {
      transform: translateY(0);
    }

    #conectar {
      background: linear-gradient(135deg, #28a745, #20c997);
      box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
      width: 100%;
      margin-top: 10px;
    }

    #conectar:hover {
      background: linear-gradient(135deg, #20c997, #17a2b8);
      box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
    }

    .power-buttons {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      margin-bottom: 20px;
    }

    .power-on {
      background: linear-gradient(135deg, #28a745, #20c997) !important;
    }

    .power-off {
      background: linear-gradient(135deg, #dc3545, #c82333) !important;
    }

    pre {
      background: rgba(0, 0, 0, 0.3);
      padding: 15px;
      border-radius: 8px;
      text-align: left;
      max-width: 100%;
      margin: 20px 0;
      color: #fff;
      font-family: 'Courier New', monospace;
      max-height: 200px;
      overflow-y: auto;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .status-indicator {
      display: inline-block;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      margin-right: 8px;
      background: #dc3545;
    }

    .status-indicator.connected {
      background: #28a745;
    }

    @media (max-width: 600px) {
      .container {
        margin: 10px;
        padding: 20px;
      }
      
      .controles {
        grid-template-columns: 1fr;
      }
      
      .power-buttons {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Logo IBCV -->
    <div class="logo">
      <img src="LogoIBCV.jpg" alt="Logo IBCV">
    </div>

    <h1>IBCV-DATASHOW</h1>

    <div class="config">
      <label>
        <span class="status-indicator" id="statusIndicator"></span>
        IP do Projetor:
        <input id="ip" type="text" placeholder="192.168.0.150" />
      </label>
      <label>
        Senha PJLink:
        <input id="senha" type="password" placeholder="Digite a senha..." />
      </label>
      <label>
        <input id="demo" type="checkbox" />
        Modo Demo (simular comandos)
      </label>
      <button id="conectar">Conectar ao Projetor</button>
    </div>

    <div class="controles">
      <div class="power-buttons">
        <button class="power-on" onclick="enviarComando('%1POWR 1')">üîå Ligar</button>
        <button class="power-off" onclick="enviarComando('%1POWR 0')">‚èª Desligar</button>
      </div>
      
      <button onclick="enviarComando('%1AVMT 31')">üö´ Mudo V√≠deo</button>
      <button onclick="enviarComando('%1AVMT 11')">üîá Mudo √Åudio</button>
      <button onclick="enviarComando('%1AVMT 30')">üì∫ Reativar V√≠deo</button>
      <button onclick="enviarComando('%1AVMT 10')">üîä Reativar √Åudio</button>
      <button onclick="enviarComando('%1INPT 31')">üì± HDMI 1</button>
      <button onclick="enviarComando('%1INPT 32')">üíª HDMI 2</button>
      <button onclick="enviarComando('%1INPT 11')">üñ•Ô∏è VGA 1</button>
      <button onclick="enviarComando('%1INPT 21')">üì° V√≠deo</button>
    </div>

    <div>
      <h3>üìã Log de Atividades:</h3>
      <pre id="log">Aguardando conex√£o...</pre>
      <button onclick="limparLog()">üóëÔ∏è Limpar Log</button>
    </div>
  </div>
   <script>
    let ipProjetor = "";
    let senhaPJLink = "";
    let modoDemo = false;
    let conectado = false;

    // Configura√ß√£o do bridge Node.js
    const ipBridge = "localhost";
    const portaBridge = 3000;

    // Service Worker para PWA
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js')
        .then(registration => console.log('SW registered'))
        .catch(error => console.log('SW registration failed'));
    }

    document.getElementById("conectar").addEventListener("click", () => {
      ipProjetor = document.getElementById("ip").value.trim();
      senhaPJLink = document.getElementById("senha").value.trim();
      modoDemo = document.getElementById("demo").checked;

      if (!ipProjetor) {
        alert("Por favor, digite o IP do projetor!");
        return;
      }

      conectado = true;
      atualizarStatusIndicador();
      
      const timestamp = new Date().toLocaleTimeString();
      logMsg(`[${timestamp}] ‚úÖ Conectado ao projetor ${ipProjetor}`);
      logMsg(`[${timestamp}] üîß Modo Demo: ${modoDemo ? 'ATIVADO' : 'DESATIVADO'}`);
      
      if (!modoDemo) {
        testarConexao();
      }
    });

    function testarConexao() {
      logMsg(`[${new Date().toLocaleTimeString()}] üîç Testando conex√£o...`);
      enviarComando('%1POWR ?'); // Consulta status de energia
    }

    function env
'demo').addEventListener('change', (e) => {
      localStorage.setItem('ibcv_demo', e.target.checked);
    });

    // Atalhos de teclado
    document.addEventListener('keydown', (e) => {
      if (e.ctrlKey) {
        switch(e.key) {
          case '1':
            e.preventDefault();
            enviarComando('%1POWR 1');
            break;
          case '0':
            e.preventDefault();
            enviarComando('%1POWR 0');
            break;
        }
      }
    });
  </script>
</body>
</html>








